{"version":3,"sources":["webpack:///src/pages/goods/GoodsList.vue","webpack:///./src/pages/goods/GoodsList.vue?98a5","webpack:///./src/pages/goods/GoodsList.vue"],"names":["GoodsList","data","page","pageSize","label","title","checked","top","bottom","condition","icons","topChecked","bottomChecked","checkedFilter","filter","this","GLOBAL","getStorage","catId","$route","query","cat_id","brand","hot","keywords","list","mounted","_this","arr","split","forEach","v","k","goodsList","methods","clickFilter","index","_this2","str","setStorage","_this3","$api","conditions","res","_list","concat","toConsumableArray_default","length","$refs","infinitescrollDemo","$emit","loadMore","_this4","where","search_name","brand_id","limit","stringify_default","beforeRouteLeave","to","from","next","path","removeStorage","goods_GoodsList","render","_vm","_h","$createElement","_c","_self","staticClass","_l","item","key","class","active","on","click","$event","_v","_s","attrs","src","_e","ref","callback","distance","scroll-top","slot","theme","type","href","goods_id","id","directives","name","rawName","value","expression","price","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/19.ffa1fe1ea322782469f9.js","sourcesContent":["<template>\n    <div class=\"goodslist\">\n        <div class=\"itembox\" v-if=\"list.length\">\n            <ul>\n                <li v-for=\"(item, index) in label\" :key=\"index\">\n                    <span :class=\"{active: item.checked}\" @click=\"clickFilter(index)\">{{ item.title }}</span>\n                    <div class=\"sort-img\">\n                        <img class=\"top\" :src=\"item.top ? icons.topChecked : icons.top\" v-if=\"index\"/>\n                        <img class=\"bottom\" :src=\"item.bottom ? icons.bottomChecked : icons.bottom\" />\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" :scroll-top=\"false\" ref=\"infinitescrollDemo\" class=\"itemgoodslist\">\n            <yd-list theme=\"4\" slot=\"list\">\n                <yd-list-item v-for='(item, key) in list' :key='key' type=\"link\" :href=\"{path:'goodsdetail',query:{goods_id:item.id}}\">\n                    <img slot='img' v-lazy='item.image_url'>\n                    <span slot='title'>{{item.name}}</span>\n                    <yd-list-other slot='other'>\n                        <div>\n                            <span class='demo-list-price'><em>¥</em>{{item.price}}</span>\n                        </div>\n                    </yd-list-other>\n                </yd-list-item>\n            </yd-list>\n        </yd-infinitescroll>\n        <yd-backtop></yd-backtop>\n    </div>\n</template>\n\n<script>\nexport default {\n    data () {\n        return {\n            page: 1,\n            pageSize: 10, // 每页10条数据\n            label: [\n                {title: '综合', checked: true, top: false, bottom: true, condition: ''},\n                {title: '销量', checked: false, top: false, bottom: false, condition: 'buy_count'},\n                {title: '价格', checked: false, top: false, bottom: false, condition: 'price'}\n            ],\n            icons: {\n                top: './static/image/graytop.png',\n                topChecked: './static/image/redtop.png',\n                bottom: './static/image/graybottom.png',\n                bottomChecked: './static/image/redbottom.png'\n            },\n            checkedFilter: 0, // 选中的第几个搜索条件 区分再次点击\n            filter: this.GLOBAL.getStorage('filter') ? this.GLOBAL.getStorage('filter') : '', // order查询的筛选条件\n            catId: this.$route.query.cat_id || 0, // 分类条件\n            brand: this.$route.query.brand, // 品牌id\n            hot: this.$route.query.hot || 0, // 热门\n            keywords: this.$route.query.keywords || 0, // 搜索条件\n            list: [] // 指定分类的商品数据\n        }\n    },\n    mounted () {\n        if (this.GLOBAL.getStorage('filter')) {\n            // 从本地取出筛选状态\n            let arr = this.GLOBAL.getStorage('filter').split(' ')\n            this.label.forEach((v, k) => {\n                if (v.condition === arr[0]) {\n                    this.checkedFilter = k // 第几个筛选条件选中\n                    v.checked = true\n                    arr[1] === 'asc' ? v.top = true : v.top = false\n                    arr[1] === 'desc' ? v.bottom = true : v.bottom = false\n                } else {\n                    v.checked = false\n                    v.top = false\n                    v.bottom = false\n                }\n            })\n        } else {\n            // 否则选中默认的\n            this.label[0].checked = true\n        }\n        this.goodsList()\n    },\n    methods: {\n        // 筛选条件点击\n        clickFilter (index) {\n            // 如果已经是选中的 再次点击切换倒序升序切换 且不是综合的筛选\n            if (this.checkedFilter === index && index !== 0) {\n                this.label[index].top = !this.label[index].top\n                this.label[index].bottom = !this.label[index].bottom\n            } else {\n                // 否则切换对应的筛选条件\n                this.label.forEach((v, k) => {\n                    if (k === index) {\n                        this.checkedFilter = index\n                        v.checked = true\n                        // 此处默认销量降序 价格升序\n                        // 销量 k = 1 价格 k = 2\n                        if (k === 2) {\n                            v.top = true\n                        } else {\n                            v.bottom = true\n                        }\n                    } else {\n                        v.checked = false\n                        v.top = false\n                        v.bottom = false\n                    }\n                })\n            }\n            // 拼接搜索条件\n            let str = ''\n            if (this.label[index].condition) str = this.label[index].top ? ' asc' : ' desc'\n            this.filter = this.label[index].condition + str\n            this.GLOBAL.setStorage('filter', this.filter)\n            this.page = 1 // 筛选条件重新第一页开始\n            this.goodsList()\n        },\n        // 获取商品数据\n        goodsList () {\n            this.$api.goodsList(this.conditions(), res => {\n                const _list = res.data.list\n                this.list = [..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                }\n                this.page++\n            })\n        },\n        // 加载更多\n        loadMore () {\n            this.$api.goodsList(this.conditions(), res => {\n                const _list = res.data.list\n                this.list = [...this.list, ..._list]\n                if (_list.length < this.pageSize) {\n                    /* 所有数据加载完毕 */\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\n                }\n                /* 单次请求数据完毕 */\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\n                this.page++\n            })\n        },\n        // 统一返回筛选条件 查询条件 分页\n        conditions () {\n            let where = {}\n            if (this.catId) {\n                where = {cat_id: this.catId}\n            } else if (this.hot) {\n                where = {hot: this.hot}\n            } else if (this.keywords) {\n                where = {search_name: this.keywords}\n            } else if (this.brand) {\n                where = {brand_id: this.brand}\n            }\n            let data = {\n                page: this.page,\n                limit: this.pageSize,\n                where: JSON.stringify(where)\n            }\n            if (this.filter) data['order'] = this.filter\n            return data\n        }\n    },\n    // 路由离开 如果不是进入商品详情页则清除筛选状态\n    beforeRouteLeave (to, from, next) {\n        if (to.path !== '/goodsdetail') {\n            this.GLOBAL.removeStorage('filter')\n        }\n        next()\n    }\n}\n</script>\n\n<style>\n    .goodslist  .itemgoodslist{\n        margin-top: .8rem;\n    }\n    .goodslist .itembox{\n        overflow: hidden;\n        zoom: 1;\n        background: #fff;\n        border-bottom: solid 1px #f5f5f5;\n        position: fixed;\n        top: 1rem;\n        width: 100%;\n        z-index: 99999;\n        padding: .1rem 0;\n        max-width: 750px;\n    }\n    .goodslist .itembox ul li{\n        width: 33.3%;\n        float: left;\n        height: .6rem;\n        line-height: .6rem;\n        position: relative;\n    }\n    .goodslist .itembox ul li img{\n        /*vertical-align: middle;*/\n    }\n    .goodslist .itembox .sort-img{\n        display: inline-block;\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        margin-left: .05rem;\n    }\n    .goodslist .itembox .sort-img img{\n        display: block;\n        width: .2rem;\n    }\n    .goodslist .itembox .sort-img img:nth-child(2n){\n        margin-top: .05rem;\n    }\n    .active {\n        color: #FF3B44;\n    }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/goods/GoodsList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"goodslist\"},[(_vm.list.length)?_c('div',{staticClass:\"itembox\"},[_c('ul',_vm._l((_vm.label),function(item,index){return _c('li',{key:index},[_c('span',{class:{active: item.checked},on:{\"click\":function($event){_vm.clickFilter(index)}}},[_vm._v(_vm._s(item.title))]),_vm._v(\" \"),_c('div',{staticClass:\"sort-img\"},[(index)?_c('img',{staticClass:\"top\",attrs:{\"src\":item.top ? _vm.icons.topChecked : _vm.icons.top}}):_vm._e(),_vm._v(\" \"),_c('img',{staticClass:\"bottom\",attrs:{\"src\":item.bottom ? _vm.icons.bottomChecked : _vm.icons.bottom}})])])}))]):_vm._e(),_vm._v(\" \"),_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",staticClass:\"itemgoodslist\",attrs:{\"callback\":_vm.loadMore,\"distance\":2,\"scroll-top\":false}},[_c('yd-list',{attrs:{\"slot\":\"list\",\"theme\":\"4\"},slot:\"list\"},_vm._l((_vm.list),function(item,key){return _c('yd-list-item',{key:key,attrs:{\"type\":\"link\",\"href\":{path:'goodsdetail',query:{goods_id:item.id}}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.image_url),expression:\"item.image_url\"}],attrs:{\"slot\":\"img\"},slot:\"img\"}),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('yd-list-other',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.price))])])])],1)}))],1),_vm._v(\" \"),_c('yd-backtop')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-df044e42\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-df044e42\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./GoodsList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-df044e42\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./GoodsList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}